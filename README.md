# Проектная работа 10 спринта
Сервис состоит из:  
- API для получения сообщений от внешних сервисов.  
- Админ панели для создания шаблонов, отправки персональных сообщений, управлением рассылками и просмотром истории.
- Scheduler'а, управляющего массовыми рассылками.
- Обработчиков сообщений, которые рендерят сообщения, отправляют по нужному каналу связи и логгируют отправку.

## Работа API и обработчиков сообщений:
### Пример запроса:
**Отправитель**: auth  
**Тип источника сообщения**: email   
**Тип события**: приветственное письмо  
```json
{
  "service": "auth",
  "channel": "email",
  "type": "welcome_letter",
  "contact": "alice@email.com",
  "payload": {
    "user_id": "ad0ec496-8c65-42c5-8fa7-3cf17bdaca7f",
    "name": "alice"
  }
}
```

При получении запроса, API передаст данные в обработчик, соответсвующий типу сообщения.
Который сформирует сообщения используя указанный шаблон и отправит его.

**NOTE**: информация об отправленных сообщения сохраняется в базу данных админки исключительно
для наглядности.

### Админка
Для удобства разработки и наглядности, выбрана Django. Хотя представляется как отдельное фронтовое приложение.
Но поставленные задачи кое-как выполняет и ладно, а у нас лапки.

## Scheduler
Служит для управления периодическими задачами. Он как бы есть, но его как бы нет. Потому что расположен в двух местах.  
Для реализации используется Celery, подключенное к админке в Django. Чтобы это нормально работало, 
проект админки пробрасывается в контейнер с Celery, где в alert описаны сами задачи. И вроде это нормальное решение. 
Сейчас реализована рассылка top10 фильмов за неделю. Запрашиваем список пользователей заинтересованных в рассылке
и фильмы от сервиса аналитики, формирует необходимые для рендера данные и передаём в нужною очередь на отправку.   
